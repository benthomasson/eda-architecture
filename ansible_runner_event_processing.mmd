graph TD
    A[Start] -->B(Read rulebook, start event plugins, and configure rules in rule engine)
    B --> C(Wait for event generated by event source)
    C --> D(Event source plugin receives event)
    D --> E(Event source plugin sends event to ruleset queue)
    E --> F(Ruleset queue sends event to rule engine)
    F --> G(Rule engine asserts new fact)
    G --> H{Do the facts match any conditions?}
    H --> |Yes| I(Run action associated with the rule that matches)
    H --> |No| J(Store fact for later consideration)
    J --> C
    I --> K{action is debug}
    K --> |Yes| KA(print debug information)
    K --> |No| L{action is print event}
    L --> |Yes| LA(print event information)
    L --> |No| M{action is none}
    M --> |Yes| MA(do nothing)
    M --> |No| N{action is run_playbook}
    N --> |Yes| NA(run ansible runner)
    N --> |No| O{action is run_module}
    O --> |Yes| OA(run ansible runner)
    O --> |No| P{action is run_job_template}
    P --> |Yes| PA(launch job via Controller API)
    P --> |No| Q{action is run_ad_hoc_command}

